%- %%%%

\chapter{Introduzione}
\label{chap:intro}

%%%%

\section{Descrizione}
\label{chap:intro-description}
Recenti sviluppi nel trattamento mirato di questo gruppo di malattie fa affidamento sull'accurata inferenza della progressione e dell'evoluzione del cancro \cite{SCiccolellaSasc}, rivelandosi una . Il cancro è la seconda causa più comune di morte \cite{worldindatacancer}, arrivando nel 2017 a contare il 17.08\% delle morti nel mondo, per un totale di 8.93 \textit{milioni} di decessi.

%%%%

\section{Storia}
\label{chap:intro-history}

Era il 1869 quando venne isolato per la prima volta nella storia dell'umanità l'\textit{Acido Desossiribonucleico}, anche conosciuto come \textit{DNA}. Il pioniere di questa scoperta è Friedrich Miescher, medico e ricercatore nato in Svizzera nel 1844. Durante il processo di scoperta, Miescher aveva realizzato che nonostante  avesse proprietà simili alle proteine, la nuova sostanza -- il DNA -- non lo era. Prima di isolare le cellule dal pus presente nelle bende chirurgiche dell'ospedale in cui lavorava, Miescher fu molto attento ad assicurarsi che il materiale che stava utilizzando fosse fresco e non contaminato. Fu solo più tardi, nel 1871, che il ricercatore iniziò a lavorare sullo sperma di salmone, una specie di pesce che affluiva numerosa durante il periodo autunnale nella città di Basel.

%%%%

\section{Nozioni di biologia}
\label{chap:intro-biology}
Al fine di poter comprendere appieno il lavoro svolto, in questa sezione verranno trattate nozioni base di biologia, partendo dalla cellula fino alla rappresentazione in modello del DNA in essa contenuta.

\subsection{La cellula}
\label{chap:intro-biology-cell}

Le cellule costituiscono le fondamenta di tutti gli organismi viventi. Il corpo umano è composto da trilioni di cellule. Esse danno forma al corpo, estraggono le sostanze nutritive dal cibo, convertono quelle sostanze nutritive in energia, ed hanno delle funzioni specifiche. Le cellule contengono anche il materiale ereditario del corpo, e possono fare copie di loro stesse \cite{whatisacell:online}. Esse sono a loro volta costituite da diverse parti, tra le quali analizzeremo il nucleo e ciò che esso contiene, il DNA.

\subsection{Il DNA}
\label{chap:intro-biology-dna}

\begin{wrapfigure}{r}{0.5 \textwidth}
    \centering
    \includegraphics[width=0.25 \textwidth]{./Images/1_dna.png}
    \caption{Il DNA}
    \label{fig:dna}
\end{wrapfigure}


Il \textit{DNA}, o \textit{acido desossiribonucleico}, è il materiale erediratio negli umani e quasi tutti gli altri organismi viventi. Quasi ogni cellula presente all'interno del corpo umano ha lo stesso identico DNA. La maggior parte del DNA è situata all'interno del nucleo della cellula (dove è chiamato \textit{DNA cellulare}), ma può trovarsi anche all'interno dei mitocondri, organi cellulari addetti alla respirazione cellulare. Le informazioni nel DNA sono conservate come un codice formato da quattro componenti chimici base (anche dette basi azotate): \textbf{adenina} (A) (\autoref{fig:dna-adenina}), \textbf{guanina} (G) (\autoref{fig:dna-guanina}), \textbf{citosina} (C) (\autoref{fig:dna-citosina}), e \textbf{timina} (T) (\autoref{fig:dna-timina}). L'ordine, o la sequenza, di queste basi determina le informazioni disponibili per costruire e mantenere operativo un organismo.

\begin{figure}[!h]
    \begin{minipage}{0.5 \textwidth}
        \centering
        \adenina
        \caption{Adenina (A)}
        \label{fig:dna-adenina}
    \end{minipage}
    \begin{minipage}{0.5 \textwidth}
        \centering
        \guanina
        \caption{Guanina (G)}
        \label{fig:dna-guanina}
    \end{minipage}
\end{figure}
\begin{figure}[!h]
    \begin{minipage}{0.5 \textwidth}
        \centering
        \citosina
        \caption{Citosina (C)}
        \label{fig:dna-citosina}
    \end{minipage}
    \begin{minipage}{0.5 \textwidth}
        \centering
        \timina
        \caption{Timina (T)}
        \label{fig:dna-timina}
    \end{minipage}
\end{figure}

Le basi del DNA si combinano tra di loro, A con T e C con G, in maniera tale da formare unità chiamate \textit{coppie base}. Assieme ad una molecola di zucchero ed una di fosfato, le basi costituiscono quello che è definito un \textit{nucleotide}. I nucleotidi sono disposti in due lunghi fili che formano una spirale chiamata \textit{doppia elica}.

Un'importante proprietà del DNA è che si può replicare, o fare copie di se stesso. Uno qualunque dei due fili di DNA \cite{WhatisDN79:online} può essere utilizzato nel processo di duplicazione per ottenere una copia identica del DNA di partenza. Questa è una fase cruciale nella divisione di una cellula, poiché la nuova copia di essa deve avere lo stesso identico DNA della cellula di origine.

\subsection{Cancro e tumore}
\label{chap:intro-biology-cancer}

\begin{figure}[h]
    \begin{minipage}{.5 \textwidth}
        \centering
        \includegraphics[width=0.75 \textwidth]{Images/1_tumor.jpg}
        \caption{\small Cancro al rene}
        \label{fig:kidney-cancer}
    \end{minipage}%
    \begin{minipage}{.5 \textwidth}
        \centering
        \includegraphics[width=0.35 \textwidth]{./Images/1_metastasi_spread.jpg}
        \caption{\small Diffusione del cancro}
        \label{fig:metastasi}
    \end{minipage}
\end{figure}

La fase di divisione di una cellula è cruciale. Si stima che durante la replicazione, solo una base su $10^9$ \cite{DNAReplication} sia errata. Vari fattori possono inoltre influenzare questa delicata fase, come l'esposizione ad agenti chimici ed irradiazione. Questi errori molto spesso sono corretti in vari modi, ma quando questo non basta, possono essere la causa scatenante che porta una cellula a diventare \textit{cancerogena}. In generale, una cellula è cancerogena quando inizia a moltiplicarsi senza controllo. Quando questo processo avviene in un tessuto solido come un organo (\autoref{fig:kidney-cancer}), muscolo od ossa, prende il nome di \textit{tumore}. Ci sono due tipi di tumore: \textit{maligno} (cancerogeno) e \textit{benigno} (non cancerogeno). I primi possono invadere i tessuti circostanti nel corpo, e mentre crescono, alcune cellule possono viaggiare attraverso il sangue (\autoref{fig:metastasi}) o altri mezzi a formare delle \textit{metastasi}, dei tumori secondari \cite{differencecancertumor:online}, mentre gli ultimi conservano le caratteristiche del tessuto di origine e non hanno la tendenza di invadere gliorgani circostanti. Un tumore benigno non è quindi un cancro, ma solo una massa che può raggiungere dimensioni considerevoli, ma non si diffonde in altre parti del corpo.

\section{Modelli di sostituzione}
\label{chap:intro-models}

In filogenetica il DNA può essere rappresentato come una sequenza di simboli, utilizzando le basi (\autoref{chap:intro-biology-dna}) corrispondenti alle posizioni degli allineamenti come caratteri.

\begin{figure}[h]
    \centering
    AGTCCAGGACAT \qquad GGCATTCAATCA
    \caption{Esempi di sequenze di DNA}
    \label{fig:dna-sequence}
\end{figure}

La \autoref{fig:dna-sequence} rappresenta un esempio di \textit{modello di sostituzione}, un modello che in biologia descrive il processo per cui una sequenza di simboli cambia in un'altra, modificandone i tratti che rappresenta. In cladistica\footnote{Metodo di classificazione degli esseri viventi che si basa sul grado di parentela, ovvero sulla distanza nel tempo dell'ultimo progenitore comune} viene utilizzato per rappresentare delle caratteristiche presenti, utilizzando il carattere ``1'', o assenti, utilizzando il carattere ``0'', in una specie.

\begin{figure}[h]
    \centering
    10011 \qquad 01110
    \caption{Esempio di modello di sostituzione in cladistica}
    \label{fig:cladistica-sequence}
\end{figure}

L'esempio in \autoref{fig:cladistica-sequence} può ipoteticamente rappresentare due specie: la prima può digerire i latticini, non depone uova, è una creatura a sangue freddo, vola e sa nuotare; la seconda non può digerire i latticini, può deporre uova, è una creatura a sangue caldo, vola e non sa nuotare. Lo stesso ragionamento può essere utilizzato per rappresentare le \textit{mutazioni} presenti all'interno di una cellula nel caso di cellule tumorali (\autoref{fig:dna-cell-mutations}).

\begin{figure}[!h]
    \centering
    \begin{tabular}{*{20}{c}}
        \mcrot{1}{l}{60}{BBS4} & \mcrot{1}{l}{60}{CAMSAP1} & \mcrot{1}{l}{60}{DOCK3} & \mcrot{1}{l}{60}{EPHA10} & \mcrot{1}{l}{60}{EYA4} & \mcrot{1}{l}{60}{HIPK4} & \mcrot{1}{l}{60}{HIST1H2AG} & \mcrot{1}{l}{60}{INTS8} & \mcrot{1}{l}{60}{MAL2} & \mcrot{1}{l}{60}{MYOM3} & \mcrot{1}{l}{60}{OAZ3} & \mcrot{1}{l}{60}{PPIG} & \mcrot{1}{l}{60}{PTPRQ} & \mcrot{1}{l}{60}{RGS11} & \mcrot{1}{l}{60}{RYR3} & \mcrot{1}{l}{60}{SERPINF2} & \mcrot{1}{l}{60}{SMOC1} & \mcrot{1}{l}{60}{TTN} & \mcrot{1}{l}{60}{TUFT1} & \mcrot{1}{l}{60}{ZNF540}\\
        \midrule \midrule
        1 & 1 & 1 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 0 & 1 & 0 & 0 \\
        1 & 1 & 1 & 1 & 1 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 \\
        1 & 1 & 1 & 1 & 1 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 \\
        1 & 1 & 1 & 1 & 1 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 \\
        \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\
        0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 1 & 1 & 1 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 \\
1 & 1 & 1 & 1 & 1 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 0
    \end{tabular}
    \caption{Dataset di cellule tumorali e delle relative mutazioni}
    % TODO: aggiungere source, chiedere a @sciccolella
    \label{fig:dna-cell-mutations}
\end{figure}

\section{Richiami di ottimizzazione matematica}
\label{chap:intro-optim}
In questa sezione verranno trattate inizialmente nozioni base di ottimizzazione matematica, in particolare sulla ricerca locale dell'ottimo, per poi introdurre due tecniche di ottimizzazione che verranno utilizzate nel \autoref{chap:art}.

\subsection{Hill climbing}
\label{chap:intro-optim-hill}
In matematica, \textit{hill climbing} è un algoritmo di ricerca dell'ottimo, migliorando la soluzione ripetutamente fino a quando non si raggiunge un criterio di ottimalità. L'idea è quella di partire da una soluzione sub-ottimale, che per analogia viene paragonato al partire alla base della collina, per poi migliorare la soluzione ottimale, che viene comparato allo scalare la collina, fino al raggiuntimento di una condizione, cioè raggiungere la cima della collina. In maniera generale, si può modellare nella forma descritta in \autoref{algo:hill-climbing}.

\begin{algorithm}[H]
    \SetAlgoLined
    inizializzazione \\
    \While{non raggiunta condizione di ottimalità} {
        seleziona e applica nuova operazione \\
        \If{nuovo stato è ottimo} {
            termina
        }
        \If{nuovo stato è migliore del precedente} {
            stato = nuovo stato
        }
    }
    \caption{Hill Climbing}
    \label{algo:hill-climbing}
\end{algorithm}

Esistono numerose variazioni di questo algoritmo, ma le più conosciute sono \textit{simple hill climbing}, \textit{steepest hill climbing} e \textit{stocasting hill climbing}, applicate a seconda delle proprietà del problema in questione. Un esempio di funzione da ottimizzare, in questo caso massimizzare, può essere come quella rappresentata in \autoref{fig:intro-optim-hill-paraboloid}, dove esiste un solo ottimo locale ($f(x, y) = 0$) cioè la funzione è monomodale\footnote{Una funzione monomodale è una funzione con un solo ottimo locale, che corrisponde anche all'ottimo globale della funzione stessa}. In questo caso, il \textit{simple hill climbing} e lo \textit{steepest hill climbing} ottengono sempre il risultato migliore.

\begin{figure}[!h]
    \begin{minipage}{0.5 \textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[samples=15,small]%
                \addplot3[surf]
                {- x^2 - y^2};
                \legend{$-x^2 - y^2$};
            \end{axis}
        \end{tikzpicture}
        \caption{Paraboloide, monomodale}
        \label{fig:intro-optim-hill-paraboloid}
    \end{minipage}
    \qquad
    \begin{minipage}{0.5 \textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[samples=15,small]%
                \addplot3[surf] {25*(sin(deg(x))^2 + sin(deg(y))^2)+x^2+y^2};
                \legend{\small $x^2 + y^2 + 25(sin^2(x) + sin^2(y))$}
            \end{axis}
        \end{tikzpicture}
        \caption{``Eggcrate'', plurimodale}
        \label{fig:intro-optim-hill-egg}
    \end{minipage}
\end{figure}
\begin{figure}[!h]
    \begin{minipage}{0.5 \textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[samples=15,view={0}{90},small]%
                \addplot3[surf]
                {- x^2 - y^2};
                \legend{$-x^2 - y^2$};
            \end{axis}
        \end{tikzpicture}
        \caption{Paraboloide, monomodale}
        \label{fig:intro-optim-hill-paraboloid-contour}
    \end{minipage}
    \begin{minipage}{0.5 \textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[samples=15,view={0}{90},small]%
                \addplot3[surf] {25*(sin(deg(x))^2 + sin(deg(y))^2)+x^2+y^2};
                \legend{\small $x^2 + y^2 + 25(sin^2(x) + sin^2(y))$}
            \end{axis}
        \end{tikzpicture}
        \caption{``Eggcrate'', plurimodale}
        \label{fig:intro-optim-hill-egg-contour}
    \end{minipage}
\end{figure}

D'altro canto, funzioni plurimodali\footnote{Una funzione plurimodale è una funzione con più di un ottimo locale. Non è detto che esista un unico ottimo globale} come ``Eggcrate'' rappresentato in \autoref{fig:intro-optim-hill-egg}, dove le tecniche citate precedentemente falliscono miseramente. Entrano quindi in gioco algoritmi di ricerca locale che ammettono, con un certo grado di libertà, di accettare un risultato peggiore di quello attuale, nella speranza di non rimanere intrappolati in un ottimo locale.

\subsection{Simulated Annealing}
\label{chap:intro-optim-sa}
Per cambiare e migliorare delle caratteristiche di un solido, in metallurgia viene utilizzata la tecnica della \textit{ricottura} (in inglese ``anneal''), dove i solidi come l'acciaio, bronzo o alluminio, vengono portati ad altissime temperature, per essere poi raffreddati ad una certa velocità chiamata \textit{cooling rate}, che determina le caratteristiche finali del metallo. Alle alte temperature, gli atomi si muovono molto velocemente e rompono le strutture cristalline che avevano formato precedentemente. Mano a mano che la temperatura cala, gli atomi rallentano, e si recristallizzano.

Analogamente, la tecnica matematica del \textit{simulated annealing} è un algoritmo di ricerca che utilizza la temperatura per riuscire a scappare da eventuali ottimi locali. Quando la temperatura è alta, l'algoritmo è meno propenso ad accettare nuovi soluzioni, anche se migliori. Mano a mano che la temperatura diminuisce, la probabilità che si accetti una soluzione migliore aumenta, fino al raggiuntimento della condizione di ottimalità, cioè quando la temperatura non può più scendere, ed il risultato non può che essere un ottimo locale.

\begin{algorithm}[h]
    \caption{Simulated Annealing}
    $best \gets random()$ \\
    $T \gets 1.0$ \\
    $T_{min} \gets 0.0001$ \\
    $cooling\_rate \gets 0.9$ \\
    \While{$T > T_{min}$}{
        $new\_best = neighbour(best)$ \\
        $ap \gets acceptance\_probability(best, new\_best, T)$ \\
        \If{$ap > random()$}{
            $best \gets new\_best$
        }
        $T = T * cooling\_rate$
    }
\end{algorithm}

Questa funzione però molto spesso fallisce, specie se si cerca di ottimizzare una funzione plurimodale come in \autoref{fig:intro-optim-hill-egg}.

\subsection{Particle Swarm Optimization}
\label{chap:intro-optim-pso}
Un'altra tecnica di ricerca dell'ottimo è quella del \textit{particle swarm optimization}. Questo algoritmo iterativo nasce inizialmente come simulazione del comportamente sociale di stormi di uccelli che si sincronizzano in volo, o un branco di pesci alla ricerca di cibo \cite{pso}: membri individuali del branco possono trarre vantaggio dalle scoperte ed esperienze passate di tutti gli altri membri durante la ricerca del cibo, un vantaggio che può rivelarsi decisivo per superare la competizione. Questa è un'ipotesi fondamentale per poter definire il \textit{particle swarm optimization}.

Nell'algoritmo, il branco di pesci viene sfruttato come analogia per lo \textit{swarm} (rappresentato in \autoref{fig:intro-optim-pso-swarm}), che indica l'insieme degli elementi appartenenti ad una popolazione, questi indicati come \textit{particelle} dello swarm.

\begin{figure}[!h]
    \begin{minipage}{0.5 \textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[scatter/classes={a=mark=o},small]%
                \addplot+[scatter,only marks,samples=20] {rand};
            \end{axis}
        \end{tikzpicture}
        \caption{\small Esempio di swarm}
        \label{fig:intro-optim-pso-swarm}
    \end{minipage}
    \begin{minipage}{0.5 \textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[small]%
                \draw[red,-stealth]
                    (axis cs:0,0) 
                    -- % = line-to
                    (axis direction cs:3,5);
                \draw[blue,->]
                    (axis cs:0,0)
                    --
                    (axis direction cs:9,7);
                \draw[purple,-stealth,solid]
                    (axis cs:0,0)
                    --
                    (axis direction cs:6,2);
                \addplot [only marks,mark=*]
                    coordinates { (0,0) (3,5) (6,2) (9,7) };
            \end{axis}
            \end{tikzpicture}
        \caption{\small Somma vettoriale tra $p_{best}$ e $s_{best}$}
        \label{fig:intro-optim-pso-sum}
    \end{minipage}
\end{figure}

Ad ogni iterazione, la posizione di ogni particella viene aggiornata per ogni dimensione del problema, basandosi sulla migliore posizione della particella $p_{best}$ e sulla migliore posizione globale dello swarm $s_{best}$ (in \autoref{fig:intro-optim-pso-sum} si vede un esempio di questa combinazione, dove la posizione finale del vettore è data dalla combinazione di due valori). Questa combinazione dei due valori migliori risolve il problema di rimanere intrappolati in un ottimo locale che presentano gli algoritmi visti nella \autoref{chap:intro-optim-hill}. Con il proseguire dell'algoritmo sarà possibile osservare che le singole particelle mano a mano convergono verso un ottimo locale, o di più, se la funzione da ottimizzare è multimodale (come in \autoref{fig:intro-optim-hill-egg}).


